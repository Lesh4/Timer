name: PR comments notifier

on: issue_comment

jobs:
  send_msg:
    name: send Telegram message with PR comment
    if: ${{ github.event.issue.pull_request }}
    runs-on: ubuntu-latest
    steps:
      - name: Get regex match
        uses: actions-ecosystem/action-regex-match@v2
        id: regex-match
        with:
          text: ${{ github.event.comment.body }}
          regex: '@all'
      - name: Send Telegram message
        uses: appleboy/telegram-action@master
        if: ${{ steps.regex-match.outputs.match != '' }}
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            ${{ github.actor }} added comment to PR. Check it out!

            🔀 PR title: ${{ github.event.title }}

            📝 Comment:
            ${{ github.event.comment.body }}
            
            📝 Comment link:
            ${{ github.event.comment.html_url }}

            📂 Repository: ${{ github.repository }}